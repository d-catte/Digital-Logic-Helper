<!DOCTYPE html>
<html lang="en">
<head>
    <!-- CSS -->
    <style>
        .background-rectangle {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100px;
            background-color: black;
            z-index: 0;
        }

        .topnav {
            background-color: #333;
            overflow: visible;
            position: relative;
        }

        .topnav a, .dropdown {
            float: left;
            color: #f2f2f2;
            text-align: center;
            padding: 14px 16px;
            text-decoration: none;
            font-size: 17px;
            cursor: pointer;
        }

        .topnav a:hover, .dropdown:hover .dropbtn {
            background-color: #ddd;
            color: black;
        }

        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
            top: 50px;
            left: 0;
        }

        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            text-align: left;
        }

        .dropdown-content a:hover {
            background-color: #f1f1f1;
        }

        #content-area {
            background-color: #222222;
            width: 100%;
            min-height: 89vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding-top: 40px;
            color: white;
        }
    </style>

    <meta charset="UTF-8">
    <title>Digital Logic Study Companion</title>
</head>
<body>
<div class="background-rectangle"></div>
<div class="topnav">
    <!-- Dropdown menus -->
    <div class="dropdown">
        <a class="active" href="#home">Home</a>
    </div>
    <div class="dropdown">
        <a class="dropbtn" href="#binary" onclick="toggleDropdown(event)">Binary</a>
        <div class="dropdown-content">
            <a href="#binary1">Conversion</a>
            <a href="#binary2">Representation</a>
            <a href="#binary3">Integer Arithmetic</a>
            <a href="#binary4">Fixed Point Arithmetic</a>
            <a href="#binary5">Floating Point Arithmetic</a>
        </div>
    </div>
    <div class="dropdown">
        <a class="dropbtn" href="#com_logic" onclick="toggleDropdown(event)">Combinational Logic</a>
        <div class="dropdown-content">
            <a href="#com_logic1">Truth Tables</a>
            <a href="#com_logic2">Boolean Algebra</a>
            <a href="#com_logic3">K-maps</a>
        </div>
    </div>
    <div class="dropdown">
        <a class="dropbtn" href="#com_components" onclick="toggleDropdown(event)">Combinational Components</a>
        <div class="dropdown-content">
            <a href="#com_components1">Gate</a>
            <a href="#com_components2">Switch/LED</a>
            <a href="#com_components3">Decoder/Encoder</a>
            <a href="#com_components4">(De)Multiplexer</a>
            <a href="#com_components5">Comparator</a>
            <a href="#com_components6">Generator/Checker</a>
            <a href="#com_components7">Adder</a>
            <a href="#com_components8">Array Multiplier</a>
        </div>
    </div>
    <div class="dropdown">
        <a class="dropbtn" href="#seq_components" onclick="toggleDropdown(event)">Sequential Components</a>
        <div class="dropdown-content">
            <a href="#seq_components1">Latch</a>
            <a href="#seq_components2">Delay/Flip-Flop</a>
            <a href="#seq_components3">Clock</a>
            <a href="#seq_components4">Counter</a>
            <a href="#seq_components5">Shift Register</a>
        </div>
    </div>
    <div class="dropdown">
        <a class="dropbtn" href="#seq_apps" onclick="toggleDropdown(event)">Sequential Apps</a>
        <div class="dropdown-content">
            <a href="#seq_apps1">Finite State Machine</a>
            <a href="#seq_apps2">Dataflow/Control Flow</a>
            <a href="#seq_apps3">FSM</a>
        </div>
    </div>
    <div class="dropdown">
        <a class="dropbtn" href="#arch" onclick="toggleDropdown(event)">Arch</a>
        <div class="dropdown-content">
            <a href="#arch1">Memory Type</a>
            <a href="#arch2">Memory Arch</a>
            <a href="#arch3">Instruction Set</a>
        </div>
    </div>
</div>
<br>

<!-- Content Page -->
<div id="content-area">
    <div class="header-container">
        <h1 style="text-align: center">Digital Logic Study Companion</h1>
        <p>
            Welcome to Digital Logic!
            This companion will provide you with practice problems for every topic covered in Digital Logic.
            Click on the navigation bar above to go to the desired topic.
        </p>
        <p style="align-self: flex-end; margin: 0; text-align: center;">
            Version 1.0.0 By Dylan M. Catte
        </p>
    </div>
</div>

<script>
    function toggleDropdown(event) {
        event.preventDefault();

        // Close all dropdowns
        const dropdowns = document.getElementsByClassName("dropdown-content");
        for (let i = 0; i < dropdowns.length; i++) {
            dropdowns[i].style.display = 'none';
        }

        // Toggle the clicked dropdown
        const dropdownContent = event.target.nextElementSibling;
        dropdownContent.style.display = dropdownContent.style.display === 'block' ? 'none' : 'block';
    }

    // Close the dropdown if the user clicks outside of it
    window.onclick = function(event) {
        if (!event.target.matches('.dropbtn')) {
            const dropdowns = document.getElementsByClassName("dropdown-content");
            for (let i = 0; i < dropdowns.length; i++) {
                const openDropdown = dropdowns[i];
                if (openDropdown.style.display === 'block') {
                    openDropdown.style.display = 'none';
                }
            }
        }
    }

    function loadContent(contentId) {
        const contentArea = document.getElementById('content-area');
        let content;

        switch (contentId) {
            case 'home':
                content = '<div class="header-container">\n' +
                    '        <h1 style="text-align: center">Digital Logic Study Companion</h1>\n' +
                    '        <p>\n' +
                    '            Welcome to Digital Logic!\n' +
                    '            This companion will provide you with practice problems for every topic covered in Digital Logic.\n' +
                    '            Click on the navigation bar above to go to the desired topic.\n' +
                    '        </p>\n' +
                    '        <p style="align-self: flex-end; margin: 0; text-align: center;">\n' +
                    '            Version 1.0.0 By Dylan M. Catte\n' +
                    '        </p>\n' +
                    '    </div>';
                break;
            case 'binary1':
                content = '<div class="header-container">\n' +
                        '<h2 id="pageIdentifier">Binary Conversion</h2>' +
                        '<div>\n' +
                            simpleDoubleInputSingleOutputWithRandomButton() +
                        '</div>' +
                     '</div>';
                break;
            case 'binary2':
                content = '<div class="header-container">\n' +
                        '<h2 id="pageIdentifier">Binary Representation</h2>' +
                        '<div>\n' +
                        simpleDoubleInputSingleOutputWithRandomButton() +
                        '</div>' +
                    '</div>';
                break;
            case 'binary3':
                content = '<div class="header-container">\n' +
                    '<h2 id="pageIdentifier">Binary Arithmetic</h2>' +
                        '<div>\n' +
                            simpleDoubleInputSingleOutputWithRandomButton() +
                        '</div>' +
                    '</div>';
                break;
            // Add more cases for other content IDs
            default:
                content = '<h1>This Topic is Currently Unavailable</h1>';
        }

        contentArea.innerHTML = content;

        switch (contentId) {
            case 'binary1':
                applyText("Decimal Number: ", "Bits: ", "Sign & Magnitude: ", "2's Complement: ");
                break;
            case 'binary2':
                applyText("Decimal Number: ", "Bits: ", "Binary: ", "Octal: ", "Hex: ");
                break;
            case 'binary3':
                applyText("Decimal Number: ", "Decimal Number: ", "Sign & Magnitude: ", "2's Complement: ");
                break;
        }
    }

    // Attach event listeners to dropdown items
    document.querySelectorAll('.dropdown-content a, .active').forEach(item => {
        item.addEventListener('click', function(event) {
            event.preventDefault();
            loadContent(event.target.getAttribute('href').substring(1));
        });
    });

    // Standard Layout
    function simpleDoubleInputSingleOutputWithRandomButton() {
        return `
    <div style="display: flex; flex-direction: column; align-items: flex-start; gap: 10px;">
        <div style="display: flex; align-items: center; gap: 5px;">
            <label id="labelInputOne" for="inputOne" style="min-width: 80px;">Input One:</label>
            <input type="text" id="inputOne" name="inputOne">
        </div>
        <div style="display: flex; align-items: center; gap: 5px;">
            <label id="labelInputTwo" for="inputTwo" style="min-width: 80px;">Input Two:</label>
            <input type="text" id="inputTwo" name="inputTwo">
        </div>
        <button id="randomizeButton" style="margin-top: 10px;">Randomize</button>
        <button id="resetButton" style="margin-top: 10px;">Reset</button>
        <button id="solveButton" style="margin-top: 10px;">Solve</button>
        <div style="display: flex; align-items: center; gap: 5px;">
            <label id="labelAnswerOne" for="answerOne" style="min-width: 80px;">Answer One: </label>
            <p id="answerOne"></p>
        </div>
        <div style="display: flex; align-items: center; gap: 5px;">
            <label id="labelAnswerTwo" for="answerTwo" style="min-width: 80px;">Answer Two: </label>
            <p id="answerTwo"></p>
        </div>
        <div style="display: flex; align-items: center; gap: 5px;">
            <label id="labelAnswerThree" for="answerThree" style="min-width: 80px;">Answer Three: </label>
            <p id="answerThree"></p>
        </div>
    </div>`;
    }

    function applyText(inputOne, inputTwo, answerOne, answerTwo, answerThree) {
        reset();
        document.getElementById('labelInputOne').textContent = inputOne;
        document.getElementById('labelInputTwo').textContent = inputTwo;
        document.getElementById('labelAnswerOne').textContent = answerOne;
        document.getElementById('labelAnswerTwo').textContent = answerTwo;
        document.getElementById('labelAnswerThree').textContent = answerThree;

        // Attach event listeners to buttons
        document.querySelectorAll('#randomizeButton').forEach(item => {
            item.addEventListener('click', function(event) {
                event.preventDefault();

                switch (document.getElementById('pageIdentifier').textContent) {
                    case 'Binary Conversion':
                        let randomVal = randomNumber(false, true);
                        document.getElementById('inputOne').value = randomVal.toString();
                        let minBits = Math.ceil(Math.log2(Math.abs(randomVal))) + 1;
                        document.getElementById('inputTwo').value = minBits.toString();
                        break;
                    case 'Binary Representation':
                        let randomVal1 = randomNumber(false, false);
                        document.getElementById('inputOne').value = randomVal1.toString();
                        let minBits1 = getRequiredBits(randomVal1);
                        document.getElementById('inputTwo').value = minBits1.toString();
                        break;
                    case 'Binary Arithmetic':
                        let randomSum1 = randomNumber(false, true);
                        let randomSum2 = randomNumber(false, true);
                        document.getElementById('inputOne').value = randomSum1.toString();
                        document.getElementById('inputTwo').value = randomSum2.toString();
                        break;
                }
            });
        });

        document.querySelectorAll('#solveButton').forEach(item => {
            item.addEventListener('click', function(event) {
                event.preventDefault();

                switch (document.getElementById('pageIdentifier').textContent) {
                    case 'Binary Conversion':
                        let value = parseInt(document.getElementById('inputOne').value, 10);
                        let bits = parseInt(document.getElementById('inputTwo').value, 10);
                        document.getElementById('answerOne').textContent = toBinarySignMag(value, bits);
                        document.getElementById('answerTwo').textContent = toTwosComplement(value, bits);
                        break;
                    case 'Binary Representation':
                        let value1 = parseInt(document.getElementById('inputOne').value, 10);
                        let bits1 = parseInt(document.getElementById('inputTwo').value, 10);
                        let overflowTest1 = toBinarySignMag(value1, bits1);
                        if (overflowTest1 === "Overflow") {
                            document.getElementById('answerOne').textContent = "Overflow";
                            document.getElementById('answerTwo').textContent = "Overflow";
                            document.getElementById('answerThree').textContent = "Overflow";
                            break;
                        }
                        document.getElementById('answerOne').textContent = toTwosComplement(value1, bits1);
                        document.getElementById('answerTwo').textContent = toOctal(value1);
                        document.getElementById('answerThree').textContent = toHex(value1);
                        break;
                    case 'Binary Arithmetic':
                        let sum1 = parseInt(document.getElementById('inputOne').value, 10);
                        let sum1Bits = getRequiredBits(sum1);
                        let sum2 = parseInt(document.getElementById('inputTwo').value, 10);
                        let sum2Bits = getRequiredBits(sum2);
                        let added1 = sum1 + sum2;
                        document.getElementById('answerOne').textContent = toBinarySignMag(added1, Math.max(sum1Bits, sum2Bits));
                        document.getElementById('answerTwo').textContent = toTwosComplement(added1, Math.max(sum1Bits, sum2Bits));
                        break;
                }
            });
        });

        document.querySelectorAll('#resetButton').forEach(item => {
            item.addEventListener('click', function(event) {
                event.preventDefault();
                reset();
            });
        });
    }

    function reset() {
        document.getElementById('inputOne').value = '';
        document.getElementById('inputTwo').value = '';
        document.getElementById('answerOne').textContent = '';
        document.getElementById('answerTwo').textContent = '';
        document.getElementById('answerThree').textContent = '';
    }

    // Random Value Generator
    /**
     * Generates a random number.
     *
     * @param {Boolean} allowDecimal - To allow decimal output
     * @param {Boolean} allowNegative - To allow negative values
     * @returns {Number}
     */
    function randomNumber(allowDecimal, allowNegative) {
        reset();
        let num = Math.random() * 2048;
        if (!allowDecimal) {
            num = Math.floor(num);
        }

        if (allowNegative && Math.round(Math.random()) === 0) {
            num *= -1;
        }
        return num;
    }

    // BINARY FUNCTIONS
    /**
     * Converts a decimal integer to a binary sign and magnitude representation
     * with a specified number of bits.
     *
     * @param {Number} integer - The integer to convert.
     * @param {Number} bits - The number of bits for the binary representation.
     * @returns {String} - The binary sign and magnitude representation, or Overflow if present.
     */
    function toBinarySignMag(integer, bits) {
        let sign;
        if (integer >= 0) {
            sign = "0 ";
        } else {
            sign = "1 ";
            integer = Math.abs(integer);
        }

        // Convert to binary and pad with leading zeros
        let binary = (integer >>> 0).toString(2).padStart(bits - 1, '0');

        // Ensure the binary string fits within the specified bit length
        if (binary.length > bits - 1) {
            return "Overflow";
        }

        return sign + binary;
    }

    function getRequiredBits(value) {
        return Math.ceil(Math.log2(Math.abs(value))) + 1;
    }

    /**
     * @param {Number} value
     * @param {Number} [bitCount = 0]
     *
     * @returns {String} binary representation of the two's complement of `value`.
     */
    function toTwosComplement(value, bitCount) {
        if (document.getElementById("answerOne").textContent === "Overflow") {
            return "Overflow";
        }

        let binaryStr;

        if (value >= 0) {
            let twosComp = value.toString(2);
            binaryStr    = padAndChop(twosComp, '0', (bitCount || twosComp.length));
        } else {
            binaryStr = (Math.pow(2, bitCount) + value).toString(2);

            if (Number(binaryStr) < 0) {
                return undefined;
            }
        }

        return `${binaryStr}`;
    }


    /**
     * @param {String} str
     * @param {String} padChar
     * @param {Number} length
     */
    function padAndChop(str, padChar, length) {
        return (Array(length).fill(padChar).join('') + str).slice(length * -1);
    }

    function toOctal(value) {
        return Number(value).toString(8);
    }

    function toHex(value) {
        return Number(value).toString(16);
    }

    function fixedPointAdd(value1, value2) {

    }
</script>

</body>
</html>